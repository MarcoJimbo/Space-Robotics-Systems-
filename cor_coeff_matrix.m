function[B] = cor_coeff_matrix(q)

    %%% function che in funzione delle variabili di giunto costruisce 
    %%% la matrice dei coefficienti delle forze di 
    %%% coriolis del manipolatore. IMPORTANTE va aggiornata
    %%% l'espressione ogni volta che vengono cambiate le caratteristiche
    %%% fisiche del manipolatore.

    % INPUT:
    % q:                    double [nx1] = variabili di giunto
    
    % OUTPUT:
    % B:                    double [nxn(n-1)/2] = matrice dei coefficienti delle forze di coriolis

    % estrazione componenti input
    % variabili di giunto
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    
    % determinazione matrice dei coefficienti delle forze di coriolis
    B = [- (197421*sin(2*q2 + q3))/100000 - (1652514097894370458901*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (273028985056712482902933*sin(2*q2))/144115188075855872000000 - (8039555118228226850069*sin(2*q2 + 2*q3 + 2*q4))/144115188075855872000000 - (4029*sin(2*q2 + 2*q3 + q4 + q5))/50000 - (7156071945708752315857*sin(2*q2 + 2*q3))/11529215046068469760000 - (84609*sin(2*q2 + q3 + q4))/200000 - (84609*sin(q3 + q4))/1000000 - (4029*sin(2*q2 + 2*q3 + 2*q4 + q5))/125000 - (28203*sin(q3))/200000 - (12087*sin(q4))/200000 - (12087*sin(2*q2 + 2*q3 + q4))/40000 - (28203*sin(2*q2 + q3 + q4 + q5))/250000, - (84609*sin(2*q2 + q3))/80000 - (1652514097894370458901*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (28203*sin(q3 + q4 + q5))/500000 - (8039555118228226850069*sin(2*q2 + 2*q3 + 2*q4))/144115188075855872000000 - (4029*sin(2*q2 + 2*q3 + q4 + q5))/50000 - (7156071945708752315857*sin(2*q2 + 2*q3))/11529215046068469760000 - (253827*sin(2*q2 + q3 + q4))/1000000 - (253827*sin(q3 + q4))/1000000 - (4029*sin(2*q2 + 2*q3 + 2*q4 + q5))/125000 - (84609*sin(q3))/80000 - (12087*sin(q4))/200000 - (12087*sin(2*q2 + 2*q3 + q4))/40000 - (28203*sin(2*q2 + q3 + q4 + q5))/500000, - (1652514097894370458901*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (28203*sin(q3 + q4 + q5))/500000 - (8039555118228226850069*sin(2*q2 + 2*q3 + 2*q4))/144115188075855872000000 - (4029*sin(2*q2 + 2*q3 + q4 + q5))/100000 - (253827*sin(2*q2 + q3 + q4))/1000000 - (253827*sin(q3 + q4))/1000000 - (4029*sin(q4 + q5))/100000 - (4029*sin(2*q2 + 2*q3 + 2*q4 + q5))/125000 - (36261*sin(q4))/200000 - (36261*sin(2*q2 + 2*q3 + q4))/200000 - (28203*sin(2*q2 + q3 + q4 + q5))/500000, - (1652514097894370458901*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (28203*sin(q3 + q4 + q5))/500000 - (4029*sin(2*q2 + 2*q3 + q4 + q5))/100000 - (4029*sin(q4 + q5))/100000 - (4029*sin(2*q2 + 2*q3 + 2*q4 + q5))/250000 - (4029*sin(q5))/250000 - (28203*sin(2*q2 + q3 + q4 + q5))/500000,                                                                                                                  0,                                                                                                                      0,                                                                                      0,                                                                                                                      0,                                                                                      0,                                                                                      0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                            0, - (28203*sin(q3 + q4 + q5))/250000 - (253827*sin(q3 + q4))/500000 - (84609*sin(q3))/40000 - (12087*sin(q4))/100000, - (28203*sin(q3 + q4 + q5))/250000 - (253827*sin(q3 + q4))/500000 - (4029*sin(q4 + q5))/50000 - (36261*sin(q4))/100000, - (28203*sin(q3 + q4 + q5))/250000 - (4029*sin(q4 + q5))/50000 - (4029*sin(q5))/125000, - (28203*sin(q3 + q4 + q5))/250000 - (253827*sin(q3 + q4))/500000 - (4029*sin(q4 + q5))/50000 - (36261*sin(q4))/100000, - (28203*sin(q3 + q4 + q5))/250000 - (4029*sin(q4 + q5))/50000 - (4029*sin(q5))/125000, - (28203*sin(q3 + q4 + q5))/250000 - (4029*sin(q4 + q5))/50000 - (4029*sin(q5))/125000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                            0,                                                                                            -(12087*sin(q4))/100000,                                                                   - (4029*sin(q4 + q5))/50000 - (36261*sin(q4))/100000,                                    - (4029*sin(q4 + q5))/50000 - (4029*sin(q5))/125000,                                                                   - (4029*sin(q4 + q5))/50000 - (36261*sin(q4))/100000,                                    - (4029*sin(q4 + q5))/50000 - (4029*sin(q5))/125000,                                    - (4029*sin(q4 + q5))/50000 - (4029*sin(q5))/125000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                            0,                                                                  (4029*sin(q4 + q5))/50000 + (12087*sin(q4))/50000,                                                                                                                      0,                                                                 -(4029*sin(q5))/125000,                                                                                                                      0,                                                                 -(4029*sin(q5))/125000,                                                                 -(4029*sin(q5))/125000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                            0,                                                                  (4029*sin(q4 + q5))/50000 + (4029*sin(q5))/125000,                                                                                                  (4029*sin(q5))/125000,                                                                                      0,                                                                                                  (4029*sin(q5))/125000,                                                                                      0,                                                                                      0];
    % fine matrice
                       
end