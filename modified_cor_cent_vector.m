function[V] = modified_cor_cent_vector(q,qd)

    %%% function che in funzione delle variabili di giunto e della loro 
    %%% derivata temporale prima costruisce il vettore delle forze di 
    %%% coriolis e centrifughe del manipolatore. IMPORTANTE va aggiornata
    %%% l'espressione ogni volta che vengono cambiate le caratteristiche
    %%% fisiche del manipolatore.

    % INPUT:
    % q:                    double [nx1] = variabili di giunto
    % qd:                   double [nx1] = derivata temporale variabili di giunto

    % OUTPUT:
    % V:                    double [nx1] = vettore delle forze di coriolis e centrifughe

    % estrazione componenti input
    % variabili di giunto
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    % derivata temporale variabili di giunto
    qd1 = qd(1);
    qd2 = qd(2);
    qd3 = qd(3);
    qd4 = qd(4);
    qd5 = qd(5);
    
    % determinazione vettore delle forze di coriolis e centrifughe
    V = [- (83060733003477199*qd1*qd2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (83060733003477199*qd1*qd3*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (83060733003477199*qd1*qd4*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (83060733003477199*qd1*qd5*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (1560398516184709685*qd1*qd2*sin(2*q2))/9223372036854775808 - (83060733003477199*qd1*qd2*sin(2*q2 + 2*q3 + 2*q4))/18446744073709551616 - (83060733003477199*qd1*qd3*sin(2*q2 + 2*q3 + 2*q4))/18446744073709551616 - (83060733003477199*qd1*qd4*sin(2*q2 + 2*q3 + 2*q4))/18446744073709551616 - (287753330365277331*qd1*qd2*sin(2*q2 + 2*q3))/4611686018427387904 - (287753330365277331*qd1*qd3*sin(2*q2 + 2*q3))/4611686018427387904 - (342309*qd1*qd2*pi*sin(2*q2 + 2*q3))/1280000 - (342309*qd1*qd3*pi*sin(2*q2 + 2*q3))/1280000 - (312543*qd1*qd2*pi*sin(2*q2 + q3 + q4))/1600000 - (937629*qd1*qd3*pi*sin(2*q2 + q3 + q4))/8000000 - (937629*qd1*qd4*pi*sin(2*q2 + q3 + q4))/8000000 - (312543*pi*qd1*qd2*sin(q3 + q4))/8000000 - (937629*pi*qd1*qd3*sin(q3 + q4))/8000000 - (937629*pi*qd1*qd4*sin(q3 + q4))/8000000 - (14883*pi*qd1*qd4*sin(q4 + q5))/800000 - (14883*pi*qd1*qd5*sin(q4 + q5))/800000 - (14883*qd1*qd2*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/1000000 - (14883*qd1*qd3*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/1000000 - (14883*qd1*qd4*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/1000000 - (14883*qd1*qd5*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/2000000 - (104181*pi*qd1*qd2*sin(q3))/1600000 - (44649*pi*qd1*qd2*sin(q4))/1600000 - (312543*pi*qd1*qd3*sin(q3))/640000 - (44649*pi*qd1*qd3*sin(q4))/1600000 - (133947*pi*qd1*qd4*sin(q4))/1600000 - (14883*pi*qd1*qd5*sin(q5))/2000000 - (44649*qd1*qd2*pi*sin(2*q2 + 2*q3 + q4))/320000 - (44649*qd1*qd3*pi*sin(2*q2 + 2*q3 + q4))/320000 - (133947*qd1*qd4*pi*sin(2*q2 + 2*q3 + q4))/1600000 - (104181*qd1*qd2*pi*sin(2*q2 + q3 + q4 + q5))/2000000 - (104181*qd1*qd3*pi*sin(2*q2 + q3 + q4 + q5))/4000000 - (104181*qd1*qd4*pi*sin(2*q2 + q3 + q4 + q5))/4000000 - (104181*qd1*qd5*pi*sin(2*q2 + q3 + q4 + q5))/4000000 - (729267*qd1*qd2*pi*sin(2*q2 + q3))/800000 - (312543*qd1*qd3*pi*sin(2*q2 + q3))/640000 - (14883*qd1*qd2*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (14883*qd1*qd3*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (14883*qd1*qd4*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (14883*qd1*qd5*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (104181*pi*qd1*qd3*sin(q3 + q4 + q5))/4000000 - (104181*pi*qd1*qd4*sin(q3 + q4 + q5))/4000000 - (104181*pi*qd1*qd5*sin(q3 + q4 + q5))/4000000 - (6563403*qd1*qd2*pi*sin(2*q2))/8000000 - (193479*qd1*qd2*pi*sin(2*q2 + 2*q3 + 2*q4))/8000000 - (193479*qd1*qd3*pi*sin(2*q2 + 2*q3 + 2*q4))/8000000 - (193479*qd1*qd4*pi*sin(2*q2 + 2*q3 + 2*q4))/8000000 - (14883*qd1*qd2*pi*sin(2*q2 + 2*q3 + q4 + q5))/400000 - (14883*qd1*qd3*pi*sin(2*q2 + 2*q3 + q4 + q5))/400000 - (14883*qd1*qd4*pi*sin(2*q2 + 2*q3 + q4 + q5))/800000 - (14883*qd1*qd5*pi*sin(2*q2 + 2*q3 + q4 + q5))/800000;
            (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (1560398516184709685*qd1^2*sin(2*q2))/18446744073709551616 + (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (287753330365277331*qd1^2*sin(2*q2 + 2*q3))/9223372036854775808 + (312543*qd1^2*pi*sin(2*q2 + q3 + q4))/3200000 - (312543*pi*qd1^2*sin(q3 + q4))/16000000 - (312543*pi*qd2^2*sin(q3 + q4))/8000000 - (937629*pi*qd3^2*sin(q3 + q4))/8000000 - (937629*pi*qd4^2*sin(q3 + q4))/8000000 - (14883*pi*qd4^2*sin(q4 + q5))/800000 - (14883*pi*qd5^2*sin(q4 + q5))/800000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/2000000 - (104181*pi*qd1^2*sin(q3))/3200000 - (44649*pi*qd1^2*sin(q4))/3200000 - (104181*pi*qd2^2*sin(q3))/1600000 - (44649*pi*qd2^2*sin(q4))/1600000 - (312543*pi*qd3^2*sin(q3))/640000 - (44649*pi*qd3^2*sin(q4))/1600000 - (133947*pi*qd4^2*sin(q4))/1600000 - (14883*pi*qd5^2*sin(q5))/2000000 + (44649*qd1^2*pi*sin(2*q2 + 2*q3 + q4))/640000 + (104181*qd1^2*pi*sin(2*q2 + q3 + q4 + q5))/4000000 + (729267*qd1^2*pi*sin(2*q2 + q3))/1600000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/8000000 - (104181*pi*qd3^2*sin(q3 + q4 + q5))/4000000 - (104181*pi*qd4^2*sin(q3 + q4 + q5))/4000000 - (104181*pi*qd5^2*sin(q3 + q4 + q5))/4000000 + (6563403*qd1^2*pi*sin(2*q2))/16000000 + (193479*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4))/16000000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + q4 + q5))/800000 + (342309*qd1^2*pi*sin(2*q2 + 2*q3))/2560000 - (937629*pi*qd2*qd3*sin(q3 + q4))/4000000 - (937629*pi*qd2*qd4*sin(q3 + q4))/4000000 - (937629*pi*qd3*qd4*sin(q3 + q4))/4000000 - (14883*pi*qd2*qd4*sin(q4 + q5))/400000 - (14883*pi*qd2*qd5*sin(q4 + q5))/400000 - (14883*pi*qd3*qd4*sin(q4 + q5))/400000 - (14883*pi*qd3*qd5*sin(q4 + q5))/400000 - (14883*pi*qd4*qd5*sin(q4 + q5))/400000 - (312543*pi*qd2*qd3*sin(q3))/320000 - (44649*pi*qd2*qd3*sin(q4))/800000 - (133947*pi*qd2*qd4*sin(q4))/800000 - (133947*pi*qd3*qd4*sin(q4))/800000 - (14883*pi*qd2*qd5*sin(q5))/1000000 - (14883*pi*qd3*qd5*sin(q5))/1000000 - (14883*pi*qd4*qd5*sin(q5))/1000000 - (104181*pi*qd2*qd3*sin(q3 + q4 + q5))/2000000 - (104181*pi*qd2*qd4*sin(q3 + q4 + q5))/2000000 - (104181*pi*qd2*qd5*sin(q3 + q4 + q5))/2000000 - (104181*pi*qd3*qd4*sin(q3 + q4 + q5))/2000000 - (104181*pi*qd3*qd5*sin(q3 + q4 + q5))/2000000 - (104181*pi*qd4*qd5*sin(q3 + q4 + q5))/2000000;
            (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (287753330365277331*qd1^2*sin(2*q2 + 2*q3))/9223372036854775808 + (312543*qd1^2*pi*sin(2*q2 + q3 + q4))/8000000 + (312543*pi*qd1^2*sin(q3 + q4))/8000000 + (312543*pi*qd2^2*sin(q3 + q4))/4000000 - (14883*pi*qd4^2*sin(q4 + q5))/800000 - (14883*pi*qd5^2*sin(q4 + q5))/800000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/2000000 + (1354353*pi*qd1^2*sin(q3))/6400000 - (44649*pi*qd1^2*sin(q4))/3200000 + (1354353*pi*qd2^2*sin(q3))/3200000 - (44649*pi*qd2^2*sin(q4))/1600000 - (44649*pi*qd3^2*sin(q4))/1600000 - (133947*pi*qd4^2*sin(q4))/1600000 - (14883*pi*qd5^2*sin(q5))/2000000 + (44649*qd1^2*pi*sin(2*q2 + 2*q3 + q4))/640000 + (104181*qd1^2*pi*sin(2*q2 + q3 + q4 + q5))/8000000 + (1354353*qd1^2*pi*sin(2*q2 + q3))/6400000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/8000000 + (104181*pi*qd1^2*sin(q3 + q4 + q5))/8000000 + (104181*pi*qd2^2*sin(q3 + q4 + q5))/4000000 + (193479*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4))/16000000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + q4 + q5))/800000 + (342309*qd1^2*pi*sin(2*q2 + 2*q3))/2560000 - (14883*pi*qd2*qd4*sin(q4 + q5))/400000 - (14883*pi*qd2*qd5*sin(q4 + q5))/400000 - (14883*pi*qd3*qd4*sin(q4 + q5))/400000 - (14883*pi*qd3*qd5*sin(q4 + q5))/400000 - (14883*pi*qd4*qd5*sin(q4 + q5))/400000 - (44649*pi*qd2*qd3*sin(q4))/800000 - (133947*pi*qd2*qd4*sin(q4))/800000 - (133947*pi*qd3*qd4*sin(q4))/800000 - (14883*pi*qd2*qd5*sin(q5))/1000000 - (14883*pi*qd3*qd5*sin(q5))/1000000 - (14883*pi*qd4*qd5*sin(q5))/1000000;
            (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (312543*qd1^2*pi*sin(2*q2 + q3 + q4))/8000000 + (312543*pi*qd1^2*sin(q3 + q4))/8000000 + (312543*pi*qd2^2*sin(q3 + q4))/4000000 + (14883*pi*qd1^2*sin(q4 + q5))/1600000 + (14883*pi*qd2^2*sin(q4 + q5))/800000 + (14883*pi*qd3^2*sin(q4 + q5))/800000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/2000000 + (44649*pi*qd1^2*sin(q4))/1600000 + (44649*pi*qd2^2*sin(q4))/800000 + (44649*pi*qd3^2*sin(q4))/800000 - (14883*pi*qd5^2*sin(q5))/2000000 + (44649*qd1^2*pi*sin(2*q2 + 2*q3 + q4))/1600000 + (104181*qd1^2*pi*sin(2*q2 + q3 + q4 + q5))/8000000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/8000000 + (104181*pi*qd1^2*sin(q3 + q4 + q5))/8000000 + (104181*pi*qd2^2*sin(q3 + q4 + q5))/4000000 + (193479*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4))/16000000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + q4 + q5))/1600000 + (14883*pi*qd2*qd3*sin(q4 + q5))/400000 + (44649*pi*qd2*qd3*sin(q4))/400000 - (14883*pi*qd2*qd5*sin(q5))/1000000 - (14883*pi*qd3*qd5*sin(q5))/1000000 - (14883*pi*qd4*qd5*sin(q5))/1000000;
            (83060733003477199*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (14883*pi*qd1^2*sin(q4 + q5))/1600000 + (14883*pi*qd2^2*sin(q4 + q5))/800000 + (14883*pi*qd3^2*sin(q4 + q5))/800000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/4000000 + (14883*pi*qd1^2*sin(q5))/4000000 + (14883*pi*qd2^2*sin(q5))/2000000 + (14883*pi*qd3^2*sin(q5))/2000000 + (14883*pi*qd4^2*sin(q5))/2000000 + (104181*qd1^2*pi*sin(2*q2 + q3 + q4 + q5))/8000000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/8000000 + (104181*pi*qd1^2*sin(q3 + q4 + q5))/8000000 + (104181*pi*qd2^2*sin(q3 + q4 + q5))/4000000 + (14883*qd1^2*pi*sin(2*q2 + 2*q3 + q4 + q5))/1600000 + (14883*pi*qd2*qd3*sin(q4 + q5))/400000 + (14883*pi*qd2*qd3*sin(q5))/1000000 + (14883*pi*qd2*qd4*sin(q5))/1000000 + (14883*pi*qd3*qd4*sin(q5))/1000000];
                    
end