function[M] = modified_mass_matrix(q)

    %%% function che in funzione delle variabili di giunto costruisce la
    %%% matrice di massa del manipolatore. IMPORTANTE va aggiornata
    %%% l'espressione ogni volta che vengono cambiate le caratteristiche
    %%% fisiche del manipolatore.

    % INPUT:
    % q:                    double [nx1] = variabili di giunto

    % OUTPUT:
    % M:                    double [nxn] = matrice di massa

    % estrazione componenti input
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    
    % determinazione matrice di massa
    M = [(35704317*pi)/64000000 + (83060733003477199*cos(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (1560398516184709685*cos(2*q2))/18446744073709551616 + (83060733003477199*cos(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (287753330365277331*cos(2*q2 + 2*q3))/9223372036854775808 + (342309*pi*cos(2*q2 + 2*q3))/2560000 + (312543*pi*cos(2*q2 + q3 + q4))/3200000 + (312543*pi*cos(q3 + q4))/3200000 + (14883*pi*cos(q4 + q5))/800000 + (14883*pi*cos(2*q2 + 2*q3 + 2*q4 + q5))/2000000 + (729267*pi*cos(q3))/1600000 + (44649*pi*cos(q4))/640000 + (14883*pi*cos(q5))/2000000 + (44649*pi*cos(2*q2 + 2*q3 + q4))/640000 + (104181*pi*cos(2*q2 + q3 + q4 + q5))/4000000 + (729267*pi*cos(2*q2 + q3))/1600000 + (14883*pi*cos(2*q2 + 2*q3 + 2*q4 + 2*q5))/8000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + (6563403*pi*cos(2*q2))/16000000 + (193479*pi*cos(2*q2 + 2*q3 + 2*q4))/16000000 + (14883*pi*cos(2*q2 + 2*q3 + q4 + q5))/800000 + 1125654866198555035/9223372036854775808,                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                               0,                                                                                                                                                               0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0, (35704317*pi)/32000000 + (312543*pi*cos(q3 + q4))/1600000 + (14883*pi*cos(q4 + q5))/400000 + (729267*pi*cos(q3))/800000 + (44649*pi*cos(q4))/320000 + (14883*pi*cos(q5))/1000000 + (104181*pi*cos(q3 + q4 + q5))/2000000 + 139696113822370363/576460752303423488, (1890141*pi)/6400000 + (937629*pi*cos(q3 + q4))/8000000 + (14883*pi*cos(q4 + q5))/400000 + (312543*pi*cos(q3))/640000 + (44649*pi*cos(q4))/320000 + (14883*pi*cos(q5))/1000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + 41729005862879563/576460752303423488, (44649*pi)/1600000 + (937629*pi*cos(q3 + q4))/8000000 + (14883*pi*cos(q4 + q5))/800000 + (133947*pi*cos(q4))/1600000 + (14883*pi*cos(q5))/1000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + 5443981925829579/576460752303423488, (14883*pi)/4000000 + (14883*pi*cos(q4 + q5))/800000 + (14883*pi*cos(q5))/2000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + 5443981925829579/1152921504606846976;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,  (1890141*pi)/6400000 + (312543*pi*cos(q3 + q4))/4000000 + (14883*pi*cos(q4 + q5))/400000 + (1354353*pi*cos(q3))/3200000 + (44649*pi*cos(q4))/320000 + (14883*pi*cos(q5))/1000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + 41729005862879563/576460752303423488,                                                                                                         (1890141*pi)/6400000 + (14883*pi*cos(q4 + q5))/400000 + (44649*pi*cos(q4))/320000 + (14883*pi*cos(q5))/1000000 + 41729005862879563/576460752303423488,                                                                            (44649*pi)/1600000 + (14883*pi*cos(q4 + q5))/800000 + (133947*pi*cos(q4))/1600000 + (14883*pi*cos(q5))/1000000 + 5443981925829579/576460752303423488,                                         (14883*pi)/4000000 + (14883*pi*cos(q4 + q5))/800000 + (14883*pi*cos(q5))/2000000 + 5443981925829579/1152921504606846976;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                    (44649*pi)/1600000 + (312543*pi*cos(q3 + q4))/4000000 + (14883*pi*cos(q4 + q5))/800000 + (44649*pi*cos(q4))/800000 + (14883*pi*cos(q5))/1000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + 5443981925829579/576460752303423488,                                                                                                            (44649*pi)/1600000 + (14883*pi*cos(q4 + q5))/800000 + (44649*pi*cos(q4))/800000 + (14883*pi*cos(q5))/1000000 + 5443981925829579/576460752303423488,                                                                                                                                           (44649*pi)/1600000 + (14883*pi*cos(q5))/1000000 + 5443981925829579/576460752303423488,                                                                          (14883*pi)/4000000 + (14883*pi*cos(q5))/2000000 + 5443981925829579/1152921504606846976;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                  (14883*pi)/4000000 + (14883*pi*cos(q4 + q5))/800000 + (14883*pi*cos(q5))/2000000 + (104181*pi*cos(q3 + q4 + q5))/4000000 + 5443981925829579/1152921504606846976,                                                                                                                                       (14883*pi)/4000000 + (14883*pi*cos(q4 + q5))/800000 + (14883*pi*cos(q5))/2000000 + 5443981925829579/1152921504606846976,                                                                                                                                          (14883*pi)/4000000 + (14883*pi*cos(q5))/2000000 + 5443981925829579/1152921504606846976,                                                                                                       (14883*pi)/4000000 + 5443981925829579/1152921504606846976];

    % fine matrice
          
end