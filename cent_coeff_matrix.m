function[C] = cent_coeff_matrix(q)

    %%% function che in funzione delle variabili di giunto costruisce 
    %%% la matrice dei coefficienti delle forze centrifughe del manipolatore.
    %%% IMPORTANTE va aggiornata l'espressione ogni volta che vengono
    %%% cambiate le caratteristiche fisiche del manipolatore.

    % INPUT:
    % q:                    double [nx1] = variabili di giunto
    
    % OUTPUT:
    % C:                    double [nxn] = matrice dei coefficienti delle forze centrifughe

    % estrazione componenti input
    % variabili di giunto
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    
    % determinazione matrice dei coefficienti delle forze centrifughe
    C = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                      0,                                                                                       0,                                                                                         0,                                                                    0;
         (75509757275879979*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (1418544105622460673*sin(2*q2))/18446744073709551616 + (75509757275879979*sin(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (523187873391410013*sin(2*q2 + 2*q3))/18446744073709551616 + (1353*pi*sin(2*q2 + 2*q3 + q4 + q5))/80000 + (31119*pi*sin(2*q2 + 2*q3))/256000 + (28413*pi*sin(2*q2 + q3 + q4))/320000 - (28413*pi*sin(q3 + q4))/1600000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/200000 - (9471*pi*sin(q3))/320000 - (4059*pi*sin(q4))/320000 + (4059*pi*sin(2*q2 + 2*q3 + q4))/64000 + (9471*pi*sin(2*q2 + q3 + q4 + q5))/400000 + (66297*pi*sin(2*q2 + q3))/160000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/800000 + (596673*pi*sin(2*q2))/1600000 + (17589*pi*sin(2*q2 + 2*q3 + 2*q4))/1600000,                          -(1353*pi*(21*sin(q3 + q4) + 35*sin(q3) + 15*sin(q4)))/800000, -(1353*pi*(28*sin(q3 + q4 + q5) + 126*sin(q3 + q4) + 525*sin(q3) + 30*sin(q4)))/1600000, -(1353*pi*(14*sin(q3 + q4 + q5) + 63*sin(q3 + q4) + 10*sin(q4 + q5) + 45*sin(q4)))/800000, -(1353*pi*(7*sin(q3 + q4 + q5) + 5*sin(q4 + q5) + 2*sin(q5)))/400000;
                                                         (75509757275879979*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (75509757275879979*sin(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (523187873391410013*sin(2*q2 + 2*q3))/18446744073709551616 + (1353*pi*sin(2*q2 + 2*q3 + q4 + q5))/80000 + (31119*pi*sin(2*q2 + 2*q3))/256000 + (28413*pi*sin(2*q2 + q3 + q4))/800000 + (28413*pi*sin(q3 + q4))/800000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/200000 + (123123*pi*sin(q3))/640000 - (4059*pi*sin(q4))/320000 + (4059*pi*sin(2*q2 + 2*q3 + q4))/64000 + (9471*pi*sin(2*q2 + q3 + q4 + q5))/800000 + (123123*pi*sin(2*q2 + q3))/640000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/800000 + (9471*pi*sin(q3 + q4 + q5))/800000 + (17589*pi*sin(2*q2 + 2*q3 + 2*q4))/1600000,  (1353*pi*(28*sin(q3 + q4 + q5) + 84*sin(q3 + q4) + 455*sin(q3) - 30*sin(q4)))/1600000,                                                               -(4059*pi*sin(q4))/160000,                                            -(1353*pi*(2*sin(q4 + q5) + 9*sin(q4)))/160000,                       -(1353*pi*(5*sin(q4 + q5) + 2*sin(q5)))/400000;
                                                                                                                                                                                          (75509757275879979*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (75509757275879979*sin(2*q2 + 2*q3 + 2*q4))/36893488147419103232 + (1353*pi*sin(2*q2 + 2*q3 + q4 + q5))/160000 + (28413*pi*sin(2*q2 + q3 + q4))/800000 + (28413*pi*sin(q3 + q4))/800000 + (1353*pi*sin(q4 + q5))/160000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/200000 + (4059*pi*sin(q4))/160000 + (4059*pi*sin(2*q2 + 2*q3 + q4))/160000 + (9471*pi*sin(2*q2 + q3 + q4 + q5))/800000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/800000 + (9471*pi*sin(q3 + q4 + q5))/800000 + (17589*pi*sin(2*q2 + 2*q3 + 2*q4))/1600000, (1353*pi*(7*sin(q3 + q4 + q5) + 21*sin(q3 + q4) + 5*sin(q4 + q5) + 15*sin(q4)))/400000,                                              (1353*pi*(sin(q4 + q5) + 3*sin(q4)))/80000,                                                                                         0,                                            -(1353*pi*sin(q5))/200000;
                                                                                                                                                                                                                                                                                                                                                                                                                            (75509757275879979*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/36893488147419103232 + (1353*pi*sin(2*q2 + 2*q3 + q4 + q5))/160000 + (1353*pi*sin(q4 + q5))/160000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/400000 + (1353*pi*sin(q5))/400000 + (9471*pi*sin(2*q2 + q3 + q4 + q5))/800000 + (1353*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/800000 + (9471*pi*sin(q3 + q4 + q5))/800000,                    (1353*pi*(7*sin(q3 + q4 + q5) + 5*sin(q4 + q5) + 2*sin(q5)))/400000,                                           (1353*pi*(5*sin(q4 + q5) + 2*sin(q5)))/400000,                                                                  (1353*pi*sin(q5))/200000,                                                                    0];
 % fine matrice
                       
end