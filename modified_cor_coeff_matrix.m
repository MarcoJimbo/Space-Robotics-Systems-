function[B] = modified_cor_coeff_matrix(q)

    %%% function che in funzione delle variabili di giunto costruisce 
    %%% la matrice dei coefficienti delle forze di 
    %%% coriolis del manipolatore. IMPORTANTE va aggiornata
    %%% l'espressione ogni volta che vengono cambiate le caratteristiche
    %%% fisiche del manipolatore.

    % INPUT:
    % q:                    double [nx1] = variabili di giunto
    
    % OUTPUT:
    % B:                    double [nxn(n-1)/2] = matrice dei coefficienti delle forze di coriolis

    % estrazione componenti input
    % variabili di giunto
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    
    % determinazione matrice dei coefficienti delle forze di coriolis
    B = [- (83060733003477199*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (1560398516184709685*sin(2*q2))/9223372036854775808 - (83060733003477199*sin(2*q2 + 2*q3 + 2*q4))/18446744073709551616 - (287753330365277331*sin(2*q2 + 2*q3))/4611686018427387904 - (14883*pi*sin(2*q2 + 2*q3 + q4 + q5))/400000 - (342309*pi*sin(2*q2 + 2*q3))/1280000 - (312543*pi*sin(2*q2 + q3 + q4))/1600000 - (312543*pi*sin(q3 + q4))/8000000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/1000000 - (104181*pi*sin(q3))/1600000 - (44649*pi*sin(q4))/1600000 - (44649*pi*sin(2*q2 + 2*q3 + q4))/320000 - (104181*pi*sin(2*q2 + q3 + q4 + q5))/2000000 - (729267*pi*sin(2*q2 + q3))/800000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (6563403*pi*sin(2*q2))/8000000 - (193479*pi*sin(2*q2 + 2*q3 + 2*q4))/8000000, - (83060733003477199*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (83060733003477199*sin(2*q2 + 2*q3 + 2*q4))/18446744073709551616 - (287753330365277331*sin(2*q2 + 2*q3))/4611686018427387904 - (14883*pi*sin(2*q2 + 2*q3 + q4 + q5))/400000 - (342309*pi*sin(2*q2 + 2*q3))/1280000 - (937629*pi*sin(2*q2 + q3 + q4))/8000000 - (937629*pi*sin(q3 + q4))/8000000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/1000000 - (312543*pi*sin(q3))/640000 - (44649*pi*sin(q4))/1600000 - (44649*pi*sin(2*q2 + 2*q3 + q4))/320000 - (104181*pi*sin(2*q2 + q3 + q4 + q5))/4000000 - (312543*pi*sin(2*q2 + q3))/640000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (104181*pi*sin(q3 + q4 + q5))/4000000 - (193479*pi*sin(2*q2 + 2*q3 + 2*q4))/8000000, - (83060733003477199*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (83060733003477199*sin(2*q2 + 2*q3 + 2*q4))/18446744073709551616 - (14883*pi*sin(2*q2 + 2*q3 + q4 + q5))/800000 - (937629*pi*sin(2*q2 + q3 + q4))/8000000 - (937629*pi*sin(q3 + q4))/8000000 - (14883*pi*sin(q4 + q5))/800000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/1000000 - (133947*pi*sin(q4))/1600000 - (133947*pi*sin(2*q2 + 2*q3 + q4))/1600000 - (104181*pi*sin(2*q2 + q3 + q4 + q5))/4000000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (104181*pi*sin(q3 + q4 + q5))/4000000 - (193479*pi*sin(2*q2 + 2*q3 + 2*q4))/8000000, - (83060733003477199*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/18446744073709551616 - (14883*pi*sin(2*q2 + 2*q3 + q4 + q5))/800000 - (14883*pi*sin(q4 + q5))/800000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + q5))/2000000 - (14883*pi*sin(q5))/2000000 - (104181*pi*sin(2*q2 + q3 + q4 + q5))/4000000 - (14883*pi*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/4000000 - (104181*pi*sin(q3 + q4 + q5))/4000000,                                                                                        0,                                                                                           0,                                                                      0,                                                                                           0,                                                                      0,                                                                      0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                   0, -(14883*pi*(28*sin(q3 + q4 + q5) + 126*sin(q3 + q4) + 525*sin(q3) + 30*sin(q4)))/8000000, -(14883*pi*(14*sin(q3 + q4 + q5) + 63*sin(q3 + q4) + 10*sin(q4 + q5) + 45*sin(q4)))/4000000, -(14883*pi*(7*sin(q3 + q4 + q5) + 5*sin(q4 + q5) + 2*sin(q5)))/2000000, -(14883*pi*(14*sin(q3 + q4 + q5) + 63*sin(q3 + q4) + 10*sin(q4 + q5) + 45*sin(q4)))/4000000, -(14883*pi*(7*sin(q3 + q4 + q5) + 5*sin(q4 + q5) + 2*sin(q5)))/2000000, -(14883*pi*(7*sin(q3 + q4 + q5) + 5*sin(q4 + q5) + 2*sin(q5)))/2000000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                   0,                                                               -(44649*pi*sin(q4))/800000,                                             -(14883*pi*(2*sin(q4 + q5) + 9*sin(q4)))/800000,                       -(14883*pi*(5*sin(q4 + q5) + 2*sin(q5)))/2000000,                                             -(14883*pi*(2*sin(q4 + q5) + 9*sin(q4)))/800000,                       -(14883*pi*(5*sin(q4 + q5) + 2*sin(q5)))/2000000,                       -(14883*pi*(5*sin(q4 + q5) + 2*sin(q5)))/2000000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                   0,                                             (14883*pi*(sin(q4 + q5) + 3*sin(q4)))/400000,                                                                                           0,                                            -(14883*pi*sin(q5))/1000000,                                                                                           0,                                            -(14883*pi*sin(q5))/1000000,                                            -(14883*pi*sin(q5))/1000000;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                   0,                                          (14883*pi*(5*sin(q4 + q5) + 2*sin(q5)))/2000000,                                                                  (14883*pi*sin(q5))/1000000,                                                                      0,                                                                  (14883*pi*sin(q5))/1000000,                                                                      0,                                                                      0];
 % fine matrice
                       
end