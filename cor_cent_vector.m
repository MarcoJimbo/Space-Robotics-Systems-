function[V] = cor_cent_vector(q,qd)

    %%% function che in funzione delle variabili di giunto e della loro 
    %%% derivata temporale prima costruisce il vettore delle forze di 
    %%% coriolis e centrifughe del manipolatore. IMPORTANTE va aggiornata
    %%% l'espressione ogni volta che vengono cambiate le caratteristiche
    %%% fisiche del manipolatore.

    % INPUT:
    % q:                    double [nx1] = variabili di giunto
    % qd:                   double [nx1] = derivata temporale variabili di giunto

    % OUTPUT:
    % V:                    double [nx1] = vettore delle forze di coriolis e centrifughe

    % estrazione componenti input
    % variabili di giunto
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    q4 = q(4);
    q5 = q(5);
    % derivata temporale variabili di giunto
    qd1 = qd(1);
    qd2 = qd(2);
    qd3 = qd(3);
    qd4 = qd(4);
    qd5 = qd(5);
    
    % determinazione vettore delle forze di coriolis e centrifughe
    V = [ - (28203*qd1*qd2*sin(q3))/200000 - (12087*qd1*qd2*sin(q4))/200000 - (84609*qd1*qd3*sin(q3))/80000 - (12087*qd1*qd3*sin(q4))/200000 - (36261*qd1*qd4*sin(q4))/200000 - (4029*qd1*qd5*sin(q5))/250000 - (12087*qd1*qd2*sin(2*q2 + 2*q3 + q4))/40000 - (12087*qd1*qd3*sin(2*q2 + 2*q3 + q4))/40000 - (36261*qd1*qd4*sin(2*q2 + 2*q3 + q4))/200000 - (28203*qd1*qd2*sin(2*q2 + q3 + q4 + q5))/250000 - (28203*qd1*qd3*sin(2*q2 + q3 + q4 + q5))/500000 - (28203*qd1*qd4*sin(2*q2 + q3 + q4 + q5))/500000 - (28203*qd1*qd5*sin(2*q2 + q3 + q4 + q5))/500000 - (197421*qd1*qd2*sin(2*q2 + q3))/100000 - (84609*qd1*qd3*sin(2*q2 + q3))/80000 - (1652514097894370458901*qd1*qd2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (1652514097894370458901*qd1*qd3*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (1652514097894370458901*qd1*qd4*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (1652514097894370458901*qd1*qd5*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/144115188075855872000000 - (28203*qd1*qd3*sin(q3 + q4 + q5))/500000 - (28203*qd1*qd4*sin(q3 + q4 + q5))/500000 - (28203*qd1*qd5*sin(q3 + q4 + q5))/500000 - (273028985056712482902933*qd1*qd2*sin(2*q2))/144115188075855872000000 - (8039555118228226850069*qd1*qd2*sin(2*q2 + 2*q3 + 2*q4))/144115188075855872000000 - (8039555118228226850069*qd1*qd3*sin(2*q2 + 2*q3 + 2*q4))/144115188075855872000000 - (8039555118228226850069*qd1*qd4*sin(2*q2 + 2*q3 + 2*q4))/144115188075855872000000 - (4029*qd1*qd2*sin(2*q2 + 2*q3 + q4 + q5))/50000 - (4029*qd1*qd3*sin(2*q2 + 2*q3 + q4 + q5))/50000 - (4029*qd1*qd4*sin(2*q2 + 2*q3 + q4 + q5))/100000 - (4029*qd1*qd5*sin(2*q2 + 2*q3 + q4 + q5))/100000 - (7156071945708752315857*qd1*qd2*sin(2*q2 + 2*q3))/11529215046068469760000 - (7156071945708752315857*qd1*qd3*sin(2*q2 + 2*q3))/11529215046068469760000 - (84609*qd1*qd2*sin(2*q2 + q3 + q4))/200000 - (253827*qd1*qd3*sin(2*q2 + q3 + q4))/1000000 - (253827*qd1*qd4*sin(2*q2 + q3 + q4))/1000000 - (84609*qd1*qd2*sin(q3 + q4))/1000000 - (253827*qd1*qd3*sin(q3 + q4))/1000000 - (253827*qd1*qd4*sin(q3 + q4))/1000000 - (4029*qd1*qd4*sin(q4 + q5))/100000 - (4029*qd1*qd5*sin(q4 + q5))/100000 - (4029*qd1*qd2*sin(2*q2 + 2*q3 + 2*q4 + q5))/125000 - (4029*qd1*qd3*sin(2*q2 + 2*q3 + 2*q4 + q5))/125000 - (4029*qd1*qd4*sin(2*q2 + 2*q3 + 2*q4 + q5))/125000 - (4029*qd1*qd5*sin(2*q2 + 2*q3 + 2*q4 + q5))/250000;
         (12087*qd1^2*sin(2*q2 + 2*q3 + q4))/80000 - (12087*qd1^2*sin(q4))/400000 - (28203*qd2^2*sin(q3))/200000 - (12087*qd2^2*sin(q4))/200000 - (84609*qd3^2*sin(q3))/80000 - (12087*qd3^2*sin(q4))/200000 - (36261*qd4^2*sin(q4))/200000 - (4029*qd5^2*sin(q5))/250000 - (28203*qd1^2*sin(q3))/400000 + (28203*qd1^2*sin(2*q2 + q3 + q4 + q5))/500000 + (197421*qd1^2*sin(2*q2 + q3))/200000 + (1652514097894370458901*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/288230376151711744000000 - (28203*qd3^2*sin(q3 + q4 + q5))/500000 - (28203*qd4^2*sin(q3 + q4 + q5))/500000 - (28203*qd5^2*sin(q3 + q4 + q5))/500000 + (273028985056712482902933*qd1^2*sin(2*q2))/288230376151711744000000 + (8039555118228226850069*qd1^2*sin(2*q2 + 2*q3 + 2*q4))/288230376151711744000000 + (4029*qd1^2*sin(2*q2 + 2*q3 + q4 + q5))/100000 + (7156071945708752315857*qd1^2*sin(2*q2 + 2*q3))/23058430092136939520000 + (84609*qd1^2*sin(2*q2 + q3 + q4))/400000 - (84609*qd1^2*sin(q3 + q4))/2000000 - (84609*qd2^2*sin(q3 + q4))/1000000 - (253827*qd3^2*sin(q3 + q4))/1000000 - (253827*qd4^2*sin(q3 + q4))/1000000 - (4029*qd4^2*sin(q4 + q5))/100000 - (4029*qd5^2*sin(q4 + q5))/100000 + (4029*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + q5))/250000 - (84609*qd2*qd3*sin(q3))/40000 - (12087*qd2*qd3*sin(q4))/100000 - (36261*qd2*qd4*sin(q4))/100000 - (36261*qd3*qd4*sin(q4))/100000 - (4029*qd2*qd5*sin(q5))/125000 - (4029*qd3*qd5*sin(q5))/125000 - (4029*qd4*qd5*sin(q5))/125000 - (28203*qd2*qd3*sin(q3 + q4 + q5))/250000 - (28203*qd2*qd4*sin(q3 + q4 + q5))/250000 - (28203*qd2*qd5*sin(q3 + q4 + q5))/250000 - (28203*qd3*qd4*sin(q3 + q4 + q5))/250000 - (28203*qd3*qd5*sin(q3 + q4 + q5))/250000 - (28203*qd4*qd5*sin(q3 + q4 + q5))/250000 - (253827*qd2*qd3*sin(q3 + q4))/500000 - (253827*qd2*qd4*sin(q3 + q4))/500000 - (253827*qd3*qd4*sin(q3 + q4))/500000 - (4029*qd2*qd4*sin(q4 + q5))/50000 - (4029*qd2*qd5*sin(q4 + q5))/50000 - (4029*qd3*qd4*sin(q4 + q5))/50000 - (4029*qd3*qd5*sin(q4 + q5))/50000 - (4029*qd4*qd5*sin(q4 + q5))/50000;
         (366639*qd1^2*sin(q3))/800000 - (12087*qd1^2*sin(q4))/400000 + (366639*qd2^2*sin(q3))/400000 - (12087*qd2^2*sin(q4))/200000 - (12087*qd3^2*sin(q4))/200000 - (36261*qd4^2*sin(q4))/200000 - (4029*qd5^2*sin(q5))/250000 + (12087*qd1^2*sin(2*q2 + 2*q3 + q4))/80000 + (28203*qd1^2*sin(2*q2 + q3 + q4 + q5))/1000000 + (366639*qd1^2*sin(2*q2 + q3))/800000 + (1652514097894370458901*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/288230376151711744000000 + (28203*qd1^2*sin(q3 + q4 + q5))/1000000 + (28203*qd2^2*sin(q3 + q4 + q5))/500000 + (8039555118228226850069*qd1^2*sin(2*q2 + 2*q3 + 2*q4))/288230376151711744000000 + (4029*qd1^2*sin(2*q2 + 2*q3 + q4 + q5))/100000 + (7156071945708752315857*qd1^2*sin(2*q2 + 2*q3))/23058430092136939520000 + (84609*qd1^2*sin(2*q2 + q3 + q4))/1000000 + (84609*qd1^2*sin(q3 + q4))/1000000 + (84609*qd2^2*sin(q3 + q4))/500000 - (4029*qd4^2*sin(q4 + q5))/100000 - (4029*qd5^2*sin(q4 + q5))/100000 + (4029*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + q5))/250000 - (12087*qd2*qd3*sin(q4))/100000 - (36261*qd2*qd4*sin(q4))/100000 - (36261*qd3*qd4*sin(q4))/100000 - (4029*qd2*qd5*sin(q5))/125000 - (4029*qd3*qd5*sin(q5))/125000 - (4029*qd4*qd5*sin(q5))/125000 - (4029*qd2*qd4*sin(q4 + q5))/50000 - (4029*qd2*qd5*sin(q4 + q5))/50000 - (4029*qd3*qd4*sin(q4 + q5))/50000 - (4029*qd3*qd5*sin(q4 + q5))/50000 - (4029*qd4*qd5*sin(q4 + q5))/50000;
         (12087*qd1^2*sin(q4))/200000 + (12087*qd2^2*sin(q4))/100000 + (12087*qd3^2*sin(q4))/100000 - (4029*qd5^2*sin(q5))/250000 + (12087*qd1^2*sin(2*q2 + 2*q3 + q4))/200000 + (28203*qd1^2*sin(2*q2 + q3 + q4 + q5))/1000000 + (1652514097894370458901*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/288230376151711744000000 + (28203*qd1^2*sin(q3 + q4 + q5))/1000000 + (28203*qd2^2*sin(q3 + q4 + q5))/500000 + (8039555118228226850069*qd1^2*sin(2*q2 + 2*q3 + 2*q4))/288230376151711744000000 + (4029*qd1^2*sin(2*q2 + 2*q3 + q4 + q5))/200000 + (84609*qd1^2*sin(2*q2 + q3 + q4))/1000000 + (84609*qd1^2*sin(q3 + q4))/1000000 + (84609*qd2^2*sin(q3 + q4))/500000 + (4029*qd1^2*sin(q4 + q5))/200000 + (4029*qd2^2*sin(q4 + q5))/100000 + (4029*qd3^2*sin(q4 + q5))/100000 + (4029*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + q5))/250000 + (12087*qd2*qd3*sin(q4))/50000 - (4029*qd2*qd5*sin(q5))/125000 - (4029*qd3*qd5*sin(q5))/125000 - (4029*qd4*qd5*sin(q5))/125000 + (4029*qd2*qd3*sin(q4 + q5))/50000;
         (4029*qd1^2*sin(q5))/500000 + (4029*qd2^2*sin(q5))/250000 + (4029*qd3^2*sin(q5))/250000 + (4029*qd4^2*sin(q5))/250000 + (28203*qd1^2*sin(2*q2 + q3 + q4 + q5))/1000000 + (1652514097894370458901*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + 2*q5))/288230376151711744000000 + (28203*qd1^2*sin(q3 + q4 + q5))/1000000 + (28203*qd2^2*sin(q3 + q4 + q5))/500000 + (4029*qd1^2*sin(2*q2 + 2*q3 + q4 + q5))/200000 + (4029*qd1^2*sin(q4 + q5))/200000 + (4029*qd2^2*sin(q4 + q5))/100000 + (4029*qd3^2*sin(q4 + q5))/100000 + (4029*qd1^2*sin(2*q2 + 2*q3 + 2*q4 + q5))/500000 + (4029*qd2*qd3*sin(q5))/125000 + (4029*qd2*qd4*sin(q5))/125000 + (4029*qd3*qd4*sin(q5))/125000 + (4029*qd2*qd3*sin(q4 + q5))/50000];
                              
end